<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head>
<title>Búsqueda de Lotes-covid19</title>
<object th:include="fragmentos :: fragmentoHead" th:remove="tag"></object>

</head>
<body>
	<object th:replace="fragmentos :: header-responsive" th:remove="tag"></object>
<div id="lotesRecibidos" class="container">
	<div class="row justify-content-center mt-1, titulo-menu">
			<h5>Gestión de lotes</h5>
    </div>
    <div class="row justify-content-left mt-3">
    	<div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">		      
				<div class="list-group">
				  <a href="/laboratorioUni/buscarLotes" class="list-group-item list-group-item-action text-white bg-secondary">Gestión Lotes</a>
				  <a href="/laboratorioUni/buscarPlacas" class="list-group-item list-group-item-action">Gestión de Placas</a>
				  <a href="#" class="list-group-item list-group-item-action">Salir</a>
				</div>
		</div>


   <div class="col-xs-12 col-sm-12 col-md-9 col-lg-9">		      
	<form action="#" th:action="@{/laboratorioUni/buscarLotes}"
			id="formularioPrueba" method="post" th:object="${busquedaLotes}"
			class="form-horizontal">
			<fieldset id="criteriosBusqueda" class="form-group border p-2">
		    <legend class="w-auto">Búsqueda Lotes</legend>
			  <div class="row">
				<div class="col-4 form-group">
				<label class="col-xs-2">Centro de procedencia:</label>
			    <select class="form-control form-control-sm" id="centro" th:field="*{idCentro}">
					<option th:each="var: ${busquedaLotes.listaCentros}"
									th:value="${var.id}" th:text="${var.nombre}"
									th:select="${busquedaLotes.idCentro}">Estado</option>
				</select>
				</div>
				<div class="col-4 form-group">
				<label class="col-xs-2">Número de Lote:</label>
						<div class="col-xs-7">
								<input type="text" class="form-control form-control-sm" id="numLote"
								th:value="${busquedaLotes.numLote}"
								th:field="*{numLote}" />
						</div>
			    </div>
			     <div class="col-4 form-group">
						<label class="col-xs-3">Estado:</label>
						<div class="col-xs-9">
							<select class="form-control form-control-sm" id="estado"
								th:field="*{codNumEstadoSeleccionado}">

								<option th:each="var: ${busquedaLotes.listaBeanEstado}"
									th:value="${var.codigo}" th:text="${var.descripcion}"
									th:selected="${busquedaLotes.codNumEstadoSeleccionado}">Estado</option>
							</select>
						</div>
						
					</div>
			  </div>
			  <div class="row">
				<div class="col-4 form-group">
			
						<label class="col-xs-2">Fecha de Entrada:</label>
						
									<input type="date" class="form-control" id="fechaEntrada"
								
								th:field="${busquedaLotes.fechaEntrada}" />
						
                   </div>
                   <div class="col-4 form-group">
			
                   	<label class="col-xs-4">Muestra:</label>
					<input type="text" class="form-control" id="muestra"
								th:value="${busquedaLotes.muestra}"
								th:field="*{muestra}" />
						</div>
                 </div>  

        <div class="row justify-content-end mt-3">
			<div class="col-2">
				<button type="button" th:onClick="|buscarResultados('lote','DESC','2','20'); return false|"  class="btn btn-secondary">Buscar</button>
			</div>
		</div>	
		</fieldset>
		<!-- campos hidden para permitir ordenar y para paginar -->
		<input type="hidden" class="form-control" id="orden" th:field="*{orden}" />
		<input type="hidden" class="form-control" id="sentidoOrden" th:field="*{sentidoOrden}" />
		</form>
		</div>
		
		<!-- Aqui vienen los resultados -->
		<div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">	&nbsp;</div>
	<div class="col-xs-12 col-sm-12 col-md-9 col-lg-9">	
		<div th:id="capaResultados" 
			class="row formPnl1">
			<table class="col-xs-12 table" th:id="tablaResultadosCabecera" style="display:none">
			 <thead class="thead-light">
				<tr>
				<th  style="text-align: left;"></th>
					<th  style="text-align: left;">#Lotes
				<!--  	<a th:onClick="|cambiarOrdenColumna('lote','DESC','0','20'); return false|">
				<span th:text="${paginaLotes.sort}"></span>
				
				<img th:if="${paginaLotes.sort == 'lote'} and ${paginaLotes.direction=='DESC'}" th:src="@{/img/asc.gif}" src="static/img/asc.gif" />	#Lote 
					</a>
					-->
					</th>
					<th style="text-align: left;">Centro</th>
					<th  style="text-align: left;">F.Entrada</th>
					<th  style="text-align: left;">#Muestras</th>
					<th  style="text-align: left;">Test</th>
					<th  style="text-align: left;">Estado</th>
				
				</tr>
				</thead>
				</table>
				<!--  datos bean -->
					<table class="col-xs-12 table" th:id="tablaResultadosLotes" >
						<tr id="trGroup"></tr>
			 	<tr id="trGroup"  th:each="unResultado,count : ${paginaLotes.getContent()}">
					
							<td width="1%">
								<input type="checkbox" name="seleccionado" th:id="seleccionado+${unResultado.id}"/>
								</td>
								<td width="1%">
								<span th:text="${unResultado.numLote}"></span>
								</td>
                            <td width="10%">
								<span th:text="${unResultado.centroProcedencia}"></span>
								</td>

								<td id="mensajes_log" width="1%">
								<span th:text="${#dates.format(unResultado.fechaEntrada, 'dd-mm-yyyy')}"></span>
								</td>
                              <td id="mensajes_log" style="text-align: center;" width="1%">
                              <a
									th:attr="data-target='#modalMuestras'+${unResultado.id}"
									data-toggle="modal"
									th:href="'#modalMuestras'+${unResultado.id}">
										<i class="fa fa-table" aria-hidden="true"
										style="font-size: 1.2em;"></i>
								</a>
								</td>
								<td id="mensajes_log" width="1%">
								<span>Covid19</span>
								</td>
								<td width="16%">
								<span th:text="${#strings.toString(unResultado.estado.Estado.descripcion)}"></span>
								  </td>
					</tr>	
					
			</table>
				<input type="button" class="btn btn-secondary"  value="Procesar lotes seleccionados"/>
		<div
				th:include="fragmentos :: paginador(${busquedaLotes.urlPaginada},${paginaLotes},${busquedaLotes.orden},${busquedaLotes.sentidoOrden},'0')"></div>
		
		</div> <!--  capa de resultados -->
		
		</div>

	</div>
	
	
</div> 
<object th:replace="fragmentos :: footer-responsive" th:remove="tag"></object>
<!--  contenedor de todo -->
	<!--  
	<script th:src="@{/js/util.js}" src="static/js/util.js"
		type="text/javascript"></script>
	<script th:src="@{/js/funcionesLotes.js}"
		src="static/js/funcionesLotes.js" type="text/javascript"></script>
	<object th:include="fragmentos :: scriptsBootstrap" th:remove="tag"></object>
	-->
	
</body>
</html>