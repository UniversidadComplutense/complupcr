<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head>
<title>Búsqueda de Lotes</title>
<object th:include="fragmentos :: fragmentoHead" th:remove="tag"></object>
<style>
/*
.selected {fa-bar-chart-ofa-bar-chart-o
    background: #eaeaea;
    color: rgba(0, 0, 0, 0.9);
}
*/
</style>
</head>
<body>
	

	<div id="fondo-nav-ini-non-responsive" class="container-fluid">&nbsp;</div>
 
	<div th:fragment="botonera-herramientas-fondo"
		id="botonera-herramientas-fondo" class="container-non-responsive">
		<div class="row">
			<div class="col-xs-2"></div>
			<div id="botonera-herramientas" class="col-xs-10">
				<ul>
					<li><a href="/laboratorioUni/buscarLotes"><i
							class="fa fa-file-o" aria-hidden="true"></i><span>Gestionar Lotes</span></a></li>
					<li><a href="/laboratorioUni/buscarPlacas"
						th:href="@{/coordinador/estadisticasTitulo}"><i
							class="fa fa-bar-chart-o" aria-hidden="true"></i><span>Gestionar Placas</span></a></li>
				
				</ul>
			</div>
		</div>
	</div>





	<div class="container-non-responsive" id="contenido-general">

		
		<h2>Gestión de Lotes</h2>

		<div class="error">
			<!-- <div th:if="${borradaPreins}">
				<h3>Lote eliminado correctamente.</h3>
			</div> -->
		</div>
	<form action="#" th:action="@{/laboratorioUni/buscarLotes}"
			id="formularioPrueba" method="post" th:object="${busquedaLotes}"
			class="form-horizontal">
			<div class="row formPnl1">
             	<div class="col-xs-12">
					<div class="form-group">
						<label class="col-xs-2">Centro de procedencia:</label>
						<div class="col-xs-7 text-left">
							<select class="form-control" id="centro"
								th:field="*{idCentro}">
								<option th:each="var: ${busquedaLotes.listaCentros}"
									th:value="${var.id}" th:text="${var.nombre}"
									th:select="${busquedaLotes.idCentro}">Estado</option>
							</select>
						</div>
					</div>
	                </div>
					
				</div>
         		<div class="col-xs-12">
					<div class="form-group">
						<label class="col-xs-2">Número de Lote:</label>
						<div class="col-xs-7">
								<input type="text" class="form-control" id="numLote"
								th:value="${busquedaLotes.numLote}"
								th:field="*{numLote}" />
						</div>
                   </div>
                   <div class="form-group">
						<label class="col-xs-2">Fecha de Entrada:</label>
						<div class="col-xs-7">
									<input type="text" class="form-control" id="fechaEntrada"
								th:value="${busquedaLotes.fechaEntrada}"
								th:field="*{fechaEntrada}" />
						</div>
                   </div>
			</div>
                 
			
			<div class="row formPnl1">

				<div class="col-xs-4">
					<div class="form-group">
						<label class="col-xs-4">Muestra:</label>
						<div class="col-xs-8">
							<input type="text" class="form-control" id="muestra"
								th:value="${busquedaLotes.muestra}"
								th:field="*{muestra}" />
						</div>
					</div>
					
					
				</div>

					<div class="form-group">
						<label class="col-xs-3">Estado:</label>
						<div class="col-xs-9">
							<select class="form-control" id="estado"
								th:field="*{codNumEstadoSeleccionado}">

								<option th:each="var: ${busquedaLotes.listaBeanEstado}"
									th:value="${var.codigo}" th:text="${var.descripcion}"
									th:selected="${busquedaLotes.codNumEstadoSeleccionado}">Estado</option>
							</select>
						</div>
						<label class="error"
							th:if="${#fields.hasErrors('codNumEstadoSeleccionado')}"
							th:errors="${busquedaLotes.codNumEstadoSeleccionado}"></label>
					</div>

				</div>

				<div class="col-xs-12 text-center">


					<input type="button" class="btn btn-default" value="Buscar"
						th:onClick="|enviarFormulario('${busquedaLotes.urlPaginada}'); return false|" />
					<input type="reset" class="btn btn-default" value="Limpiar"
						th:onClick="|vaciar('form'); return false|" />
				</div>

				<!-- <div class="col-xs-12 text-center">
					<label class="alert alert-info"
						th:if="${beanBusqueda.mensaje != null}"
						th:text="${beanBusqueda.mensaje}">mensaje</label> <label
						class="error" th:if="${#fields.hasErrors('mensaje')}"
						th:errors="${beanBusqueda.mensaje}"></label>
				</div>

    -->
			




		</form>
		<!-- Aqui vienen los resultados -->
		<div th:unless="${(paginaLotes == null)}"
			class="row formPnl1">
			<table class="col-xs-12 table1b" id="tablaResultados">
				<tr>
					<th width="1%" style="text-align: left;">Seleccionar</th>
					<th width="1%" style="text-align: left;">#Lote</th>
					<th width="6%" style="text-align: left;">Centro de Procedencia</th>
					<th width="10%" style="text-align: left;">Fecha.Entrada</th>
					<th width="6%" style="text-align: left;">#Muestras</th>
					<th width="6%" style="text-align: left;">Test</th>
					<th width="6%" style="text-align: left;">Estado</th>
				</tr>
				<!--  datos bean -->
				<tr
					th:each="unResultado,count : ${paginaLotes.getContent()}"
					th:id="filaResultados">
					<td colspan="12">
						<table class="table1b" width="100%" th:id="tablaRes" id="tablaRes">
							<tr
								th:id="trGroup + ${unResultado.id}">
								<td width="1%">
								<input type="checkbox" name="seleccionado" th:id="seleccionado+${unResultado.id}"/>
								</td>
								<td width="1%">
								<span th:text="${unResultado.numLote}"></span>
								</td>

								<td id="mensajes_log" width="1%">
								<span th:text="${unResultado.fechaEntrada}"></span>
								</td>
                              <td id="mensajes_log" width="1%">
                              <a
									th:attr="data-target='#modalMuestras'+${unResultado.id}"
									data-toggle="modal"
									th:href="'#modalMuestras'+${unResultado.id}">
										<i class="fa fa-trash-o" aria-hidden="true"
										style="font-size: 1.2em;"></i>ir a muestras
								</a>
								</td>
								<td id="mensajes_log" width="1%">
								<span>Covid19</span>
								</td>
								<td width="6%">
									
											<div class="bolaRoja" title="Pendiente de Entrega"
												th:if="${#strings.toString(unResultado.Estado) == 'PendienteEntrega'}">&nbsp;</div>
											<div class="bolaVerde" title="Entregado"
												th:if="${#strings.toString(unResultado.Estado) == 'Entregado'}">&nbsp;</div>
											<div class="bolaAmarilla" title="Validación Erronea"
												th:if="${#strings.toString(unResultado.Estado) == 'ValidacionErronea'}">&nbsp;</div>
											<div class="bolaBlanca" title="Pendiente de Entrega"
												th:if="${#strings.toString(unResultado2.Estado) == 'PendienteEntrega'}">&nbsp;</div>

											<div class="bolaRoja" title="Pendiente de Cotejo"
												th:if="${#strings.toString(unResultado2.Estado) == 'PendienteCotejo'}">&nbsp;</div>
											<div class="bolaVerde" title="Cotejada"
												th:if="${#strings.toString(unResultado2.Estado) == 'Cotejada'}">&nbsp;</div>
											<div class="bolaAmarilla" title="Cotejo Erroneo"
												th:if="${#strings.toString(unResultado2.Estado) == 'CotejoErroneo'}">&nbsp;</div>
											<div class="bolaBlanca" title="No cotejada"
												th:if="${#strings.toString(unResultado2.Estado) == 'NoCotejada'}">&nbsp;</div>

											<div class="bolaAmarilla" title="Pendiente de Autorización"
												th:if="${#strings.toString(unResultado2.Estado) == 'PendienteAutorizacion'}">&nbsp;</div>
											<div class="bolaVerde" title="Propuesta Autorizada"
												th:if="${(#strings.toString(unResultado2.Estado) == 'Autorizada')|| (#strings.toString(unResultado2.Estado) == 'PropuestaAutorizacion')}">&nbsp;</div>
											<div class="bolaRoja" title="Propuesta No Autorizada"
												th:if="${(#strings.toString(unResultado2.Estado) == 'NoAutorizada') || (#strings.toString(unResultado2.Estado) == 'PropuestaRechazo')}">&nbsp;</div>
											<div class="bolaBlanca" title="No Necesita Autorización"
												th:if="${#strings.toString(unResultado2.Estado) == 'NoNecesitaAutorizacion'}">&nbsp;</div>
											<!--  Siguiente bola de pago -->
											<div th:id="estados" class="bolaRoja"
												title="Pendiente de pago"
												th:if="${#strings.toString(unResultado2.Estado) == 'PendientePago'}">
												&nbsp;</div>
											<div th:id="estados" class="bolaVerde" title="Pagado"
												th:if="${#strings.toString(unResultado2.Estado) == 'Pagado'}">
												&nbsp;</div>
											<div th:id="estados" class="bolaBlanca" title="Sin pago"
												th:if="${#strings.toString(unResultado2.Estado) == 'SinPago'}">
												&nbsp;</div>


								</td>
								<td width="10%"
									th:text="${#strings.toString(unResultado.fechaAlta)}"
									th:id="fechaAlta" id="fechaAlta"></td>
								<td width="6%" th:text="${unResultado.documento}"
									th:id="documento" id="documento"></td>
								<td width="12%" th:text="${unResultado.apellido1}"
									th:id="apellido1" id="apellido1"></td>
								<td width="11%" th:text="${unResultado.apellido2}"
									th:id="apellido2" id="apellido2"></td>
								<td width="12%" th:text="${unResultado.nombre}" th:id="nombre"
									id="nombre"></td>
								<!--   <td width="16%" th:text="${unResultado.email}" th:id="email" id="email">
				  -->
								<td width="1%">
									<!--  VENTANA EMAIL -->
									<div th:id="'modEmail' + ${unResultado.codNumPreinscripcion}"
										class="modal fade modal1 in" role="dialog">
										<div class="modal-dialog">
											<div class="modal-content">
												<div class="modal-header">
													<h3 class="modal-title error">Correo electrónico del
														alumno</h3>
													<button class="close" data-dismiss="modal" type="button">×</button>
												</div>
												<div class="modal-body">
													<ul style="font-weight: bold;">
														<li><a th:href="|mailto:${unResultado.email}"><span
																th:text="${unResultado.email}"></span></a></li>
													</ul>
												</div>
												<div class="modal-footer">
													<button class="btn btn-default" data-dismiss="modal"
														type="button">Cerrar</button>
												</div>
											</div>
										</div>
									</div> <!--  fin ventana email --> <!--  VENTANA TELEFONO -->
									<div th:id="'modPhone' + ${unResultado.codNumPreinscripcion}"
										class="modal fade modal1 in" role="dialog">
										<div class="modal-dialog">
											<div class="modal-content">
												<div class="modal-header">
													<h3 class="modal-title error">Teléfono del alumno</h3>
													<button class="close" data-dismiss="modal" type="button">×</button>
												</div>
												<div class="modal-body">
													<ul style="font-weight: bold;">
														<li><span th:text="${unResultado.telefono}"></span></li>
													</ul>
												</div>
												<div class="modal-footer">
													<button class="btn btn-default" data-dismiss="modal"
														type="button">Cerrar</button>
												</div>
											</div>
										</div>
									</div> <!--  fin ventana telefono --> <a
									th:attr="data-target='#modEmail'+${unResultado.codNumPreinscripcion}"
									data-toggle="modal"
									th:href="'#modEmail'+ ${unResultado.codNumPreinscripcion}">
										<i class="fa fa-envelope-o fa-lg" aria-hidden="true"
										style="font-size: 1.2em;"></i>
								</a>
								</td>
								<td width="5%">
									<!--  <td width="3%" th:text="${unResultado.telefono}" th:id="telefono" id="telefono"> -->
									<a
									th:attr="data-target='#modPhone'+${unResultado.codNumPreinscripcion}"
									data-toggle="modal"
									th:href="'#modPhone'+ ${unResultado.codNumPreinscripcion}">
										<i class="fa fa-phone-square fa-lg" aria-hidden="true"
										style="font-size: 1.2em;"></i>
								</a>
								</td>
								<td width="6%" th:text="${unResultado.codigoTitulo}"
									th:id="tituloSeleccionadoAux" id="tituloSeleccionadoAux"></td>
								<td width="15%" th:text="${unResultado.estadoGlobal}"
									th:id="estado" id="estado"></td>
								<td width="5%" th:text="${unResultado.convocatoria}"
									th:id="convocatoria" id="convocatoria"></td>
								<!--   añadido DIANA, opcion BORRAR  -->
								<!-- solo podrá borrar la seccion -->
								<td th:if="${formUserSecretaria.rol == 'ROLE_SECCION'}"
									width="1%">
									<!--    <a data-toggle="modal" href="#modal2"  th:href="@{/gestor/eliminarUnaPreinscripcion(codNumPreins=${unResultado.codNumPreinscripcion}, codNumTitulo=${unResultado.codNumTitulo},email=${unResultado.email},codNumConvocatoria=${unResultado.codNumConvocatoria},convocatoria=${unResultado.convocatoria})}">
			 			--> <!--     <a  th:onclick="|ConfirmDemo('${unResultado.codNumPreinscripcion}', '${unResultado.codNumTitulo}','${unResultado.email}','${unResultado.codNumConvocatoria}','${unResultado.convocatoria}'); return false|">
			 		--> <!--  Yoli --> <!-- hacemos un modal distinto por cada preinscripcion para avisar que hemos pulsado en su borrar; el id de cada modal será modEliminarcodnumPreins -->
									<div
										th:id="'modEliminar' + ${unResultado.codNumPreinscripcion}"
										class="modal fade modal1 in" role="dialog">
										<div class="modal-dialog modal-sm">
											<div class="modal-content">
												<div class="modal-header">
													<button class="close" data-dismiss="modal" type="button">×</button>
													<h3 class="modal-title error">ATENCIÓN</h3>
												</div>
												<div class="modal-body">
													<label>¿Está seguro que desea eliminar la siguiente
														preinscripción?</label>
													<ul style="font-weight: bold;">
														<li>Cód. Título: <span
															th:text="${unResultado.codNumTitulo}"></span></li>
														<li>Alumno: <span th:text="${unResultado.email}"></span></li>
													</ul>
													<label>Si esta preinscripción es la única del
														estudiante, borrarla implicará la eliminación de todos sus
														datos.</label>
												</div>
												<div class="modal-footer">
													<button class="btn btn-default" type="button"
														th:onclick="|eliminarPreinscripcion('${unResultado.codNumPreinscripcion}', '${unResultado.codNumTitulo}','${unResultado.email}','${unResultado.codNumConvocatoria}','${unResultado.convocatoria}','${beanListaPreinscripciones.number}','${beanListaPreinscripciones.size}','${variableJson}', '${beanBusqueda.sentidoOrden}', '${beanBusqueda.orden}'); return false|">Confirmar</button>
													<!--  el data-dismiss lo que hace es cerrar el modal -->
													<button class="btn btn-default" data-dismiss="modal"
														type="button">Cancelar</button>
												</div>
											</div>
										</div>
									</div> <!--/*  Yoli */--> <a
									th:attr="data-target='#modEliminar'+${unResultado.codNumPreinscripcion}"
									data-toggle="modal"
									th:href="'#modEliminar'+ ${unResultado.codNumPreinscripcion}">
										<i class="fa fa-trash-o" aria-hidden="true"
										style="font-size: 1.2em;"></i>
								</a>
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</div> <!--  capa de resultados -->
		</div>
		

	<!--  
	<script th:src="@{/js/util.js}" src="static/js/util.js"
		type="text/javascript"></script>
	<script th:src="@{/js/funcionesLotes.js}"
		src="static/js/funcionesLotes.js" type="text/javascript"></script>
	<object th:include="fragmentos :: scriptsBootstrap" th:remove="tag"></object>
	-->
</body>
</html>